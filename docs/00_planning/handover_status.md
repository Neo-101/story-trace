# å…³ç³»æ¼”åŒ–åˆ†æç³»ç»Ÿ (Relationship Evolution Analysis) - è¿›åº¦äº¤æ¥æ–‡æ¡£

## ğŸ“… é¡¹ç›®çŠ¶æ€ (Current Status)
æˆªè‡³ **2026-02-23**ï¼Œæˆ‘ä»¬æˆåŠŸæ„å»ºå¹¶ä¿®å¤äº†åŸºäº LLM çš„å…¨æ ˆå…³ç³»åˆ†æç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿå…è®¸ç”¨æˆ·åœ¨å‰ç«¯å›¾è°±ä¸­é€‰æ‹©ä¸¤ä¸ªå®ä½“ï¼Œè§¦å‘åå°å¼‚æ­¥ä»»åŠ¡ï¼Œç”ŸæˆåŒ…å«ä¿¡ä»»åº¦ã€æµªæ¼«å€¼ã€å†²çªå€¼åŠå™äº‹æ€»ç»“çš„å…³ç³»æ¼”åŒ–æ—¶é—´çº¿ã€‚

### âœ… å·²å®ŒæˆåŠŸèƒ½ (Completed)
1.  **å¼‚æ­¥ä»»åŠ¡ç³»ç»Ÿ**:
    *   åç«¯ (`backend/routers/jobs.py`): ä½¿ç”¨ FastAPI `BackgroundTasks` å¤„ç†è€—æ—¶åˆ†æã€‚
    *   å‰ç«¯ (`JobStatusWidget.vue`): æ‚¬æµ®æ°”æ³¡å®æ—¶æ˜¾ç¤ºåˆ†æè¿›åº¦ã€‚
2.  **æ ¸å¿ƒåˆ†æå¼•æ“**:
    *   `NarrativeEvolutionEngine`: ç®¡ç†çŠ¶æ€æ¼”åŒ–ã€ç¼“å­˜è¯»å†™ã€‚
    *   `RelationshipPlugin`: å¤„ç† Prompt ç”Ÿæˆã€LLM è°ƒç”¨ä¸ç»“æœè§£æã€‚
    *   **ä¼˜åŒ–**: æ”¯æŒâ€œå¼±äº¤äº’â€ï¼ˆåŒåœºå‡ºç°ï¼‰åˆ¤å®šï¼›Prompt æ¨¡æ¿åŒ– (`prompts.py`)ï¼›ç»Ÿä¸€æ•°æ®å¥‘çº¦ (`AnalysisEvent`)ã€‚
3.  **å‰ç«¯å¯è§†åŒ–**:
    *   `RelationshipArcDrawer.vue`: å±•ç¤º Insight é¢æ¿ï¼ˆæŒ‡æ ‡ + æ»šåŠ¨æ‘˜è¦ï¼‰å’Œäº¤äº’æ—¶é—´çº¿ã€‚
    *   **äº¤äº’**: æ–°å¢â€œæ¸…é™¤ç¼“å­˜â€æŒ‰é’®ï¼ˆçº¢è‰²åƒåœ¾æ¡¶ï¼‰ï¼Œæ–¹ä¾¿é‡ç½®åˆ†æã€‚
4.  **Bug ä¿®å¤**:
    *   è§£å†³äº† FastAPI åƒµå°¸è¿›ç¨‹å¯¼è‡´çš„â€œä»£ç ä¿®æ”¹ä¸ç”Ÿæ•ˆâ€é—®é¢˜ã€‚
    *   ä¿®å¤äº† GET æ¥å£å‚æ•°ç¼ºå¤±å¯¼è‡´çš„ 500 é”™è¯¯ã€‚
    *   ä¿®å¤äº†â€œå…‰é€Ÿç»“æŸä½†ç»“æœä¸ºç©ºâ€çš„é€»è¾‘æ¼æ´ï¼ˆåˆ«ååŠ è½½ + ä¸¥æ ¼è¿‡æ»¤ï¼‰ã€‚

## ğŸš§ å¾…è§£å†³æŒ‘æˆ˜ (Challenges)
å½“å‰æœ€å¤§çš„ç—›ç‚¹æ˜¯ **é•¿æ–‡æœ¬åˆ†æé€Ÿåº¦**ã€‚
*   **é—®é¢˜**: é€ç« ä¸²è¡Œåˆ†æï¼ˆChapter N ä¾èµ– Chapter N-1ï¼‰å¯¼è‡´å…¨ä¹¦ï¼ˆå‡ ç™¾ç« ï¼‰åˆ†æè€—æ—¶æé•¿ã€‚
*   **ç°çŠ¶**: ç›®å‰ä»…è·³è¿‡äº†â€œå®Œå…¨æ— äº¤äº’â€çš„ç« èŠ‚ï¼Œä½†å¯¹äºâ€œæœ‰äº¤äº’ä½†ä¿¡æ¯é‡ä½â€çš„ç« èŠ‚ä»ä¼šè°ƒç”¨ LLMã€‚

## ğŸš€ ä¸‹ä¸€æ­¥è®¡åˆ’ (Next Steps)
åœ¨æ–°å¯¹è¯ä¸­ï¼Œæˆ‘ä»¬å°†èšç„¦äº **æ€§èƒ½ä¼˜åŒ– (Acceleration)**ã€‚

### 1. å…³é”®å¸§è·³è·ƒ (Keyframe Skipping) - *High Priority*
*   **ç›®æ ‡**: ä»…å¯¹â€œé«˜èƒ½ç« èŠ‚â€è°ƒç”¨ LLMï¼Œå…¶ä»–ç« èŠ‚å¤ç”¨çŠ¶æ€æˆ–è¿›è¡Œç®€å•è§„åˆ™æ›´æ–°ã€‚
*   **æ–¹æ¡ˆ**: 
    1.  é¢„æ‰«æï¼šåœ¨ Job å¼€å§‹å‰ï¼Œå¿«é€Ÿè®¡ç®—å…¨ä¹¦å„ç« çš„â€œäº’åŠ¨å¯†åº¦â€ã€‚
    2.  é˜ˆå€¼è¿‡æ»¤ï¼šå¯†åº¦ä½äº X çš„ç« èŠ‚ï¼Œç›´æ¥ Copy ä¸Šä¸€ç« çŠ¶æ€ã€‚
    3.  è·³è·ƒæ‰§è¡Œï¼šä»…å¯¹å¯†åº¦ > X çš„ç« èŠ‚è§¦å‘ `evolve_state`ã€‚

### 2. å¹¶è¡ŒåŒ–å°è¯• (Parallelization) - *Medium Priority*
*   **ç›®æ ‡**: æ¢ç´¢ MapReduce æ¨¡å¼ï¼Œå°†å…¨ä¹¦åˆ‡å—å¹¶è¡Œåˆ†æï¼Œæœ€ååˆå¹¶ã€‚

### 3. ç¼“å­˜å…±äº« (Cloud Cache) - *Low Priority*
*   **ç›®æ ‡**: å»ºç«‹å…¬å…±çŸ¥è¯†åº“ï¼Œå¤ç”¨å…¶ä»–ç”¨æˆ·çš„åˆ†æç»“æœã€‚

## ğŸ“ å¯åŠ¨æ–°å¯¹è¯çš„ Prompt (Copy & Paste)
è¯·å¤åˆ¶ä»¥ä¸‹å†…å®¹ä½œä¸ºæ–°å¯¹è¯çš„å¼€åœºç™½ï¼š

> æˆ‘ä»¬æ­£åœ¨å¼€å‘ StoryTrace çš„å…³ç³»æ¼”åŒ–åˆ†æç³»ç»Ÿã€‚ç›®å‰å·²å®Œæˆäº†å…¨æ ˆå¼‚æ­¥åˆ†ææµç¨‹ï¼ˆFastAPI + Vue3 + LLMï¼‰ï¼Œè§£å†³äº†åƒµå°¸è¿›ç¨‹å’Œå‚æ•°ç¼ºå¤±ç­‰ Bugï¼Œç³»ç»Ÿå·²ç¨³å®šå¯ç”¨ã€‚
> 
> **å½“å‰ä»»åŠ¡**ï¼šæˆ‘ä»¬éœ€è¦è§£å†³â€œå…¨ä¹¦åˆ†æé€Ÿåº¦è¿‡æ…¢â€çš„æ€§èƒ½ç“¶é¢ˆã€‚
> **ä¸Šä¸‹æ–‡**ï¼š
> 1.  ä»£ç åº“å·²åŒ…å« `JobManager`, `NarrativeEvolutionEngine`, `RelationshipPlugin` ç­‰æ ¸å¿ƒæ¨¡å—ã€‚
> 2.  å·²å®ç°â€œæ¸…é™¤ç¼“å­˜â€åŠŸèƒ½æ–¹ä¾¿è°ƒè¯•ã€‚
> 3.  ä¸Šè½®å¯¹è¯ç»“è®ºï¼šå»ºè®®é‡‡ç”¨ **â€œå…³é”®å¸§è·³è·ƒ (Keyframe Skipping)â€** ç­–ç•¥ï¼Œå³é¢„å…ˆè®¡ç®—äº’åŠ¨å¯†åº¦ï¼Œè·³è¿‡ä½ä¿¡æ¯é‡ç« èŠ‚çš„ LLM è°ƒç”¨ã€‚
> 
> **è¯·ååŠ©æˆ‘**ï¼š
> 1.  åˆ†æ `backend/routers/jobs.py` å’Œ `relationship.py`ï¼Œè®¾è®¡ä¸€ä¸ªâ€œäº’åŠ¨å¯†åº¦é¢„è®¡ç®—â€ç®—æ³•ã€‚
> 2.  ä¿®æ”¹ `run_relationship_analysis_task`ï¼Œå®ç°â€œä½å¯†åº¦ç« èŠ‚è‡ªåŠ¨è·³è¿‡â€é€»è¾‘ã€‚
